<div class="explore-page">
  <div class="explore-container">

    <!-- ================= CARD DE BUSCA ================= -->
    <div class="explore-search-card mb-5">

      <%= link_to "Buscar pessoas",
            users_path,
            class: "btn btn-outline-primary mb-3" %>

      <h1>Explorar restaurantes</h1>
      <h4 class="mb-4">Descubra novos sabores pela cidade</h4>

      <%= form_with url: explore_path, method: :get, local: true do %>

        <!-- BUSCA + PRE√áO + FILTRAR -->
        <div class="filter-row">

          <div class="filter-field">
            <%= label_tag :query, "Buscar" %>
            <%= text_field_tag :query,
                  params[:query],
                  class: "form-control form-control-sm",
                  placeholder: "Nome, infos, endere√ßo..." %>
          </div>

          <div class="filter-field small">
            <%= label_tag :max_price, "Pre√ßo at√© (R$)" %>
            <%= select_tag :max_price,
                  options_for_select(@price_options, params[:max_price]),
                  class: "form-select form-select-sm" %>
          </div>

          <div class="filter-action">
            <%= submit_tag "Filtrar", class: "btn btn-filtrar" %>
          </div>

        </div>

      <% end %>
    </div>
    <!-- ================= FIM CARD DE BUSCA ================= -->


    <!-- ================= CATEGORIAS ================= -->
    <div class="category-buttons mb-5">
      <% Restaurant::CATEGORIES.each do |cat| %>
        <%= button_tag cat,
              type: :submit,
              name: :category,
              value: cat,
              class: "category-btn #{'active' if params[:category] == cat}" %>
      <% end %>
    </div>
    <!-- ================= FIM CATEGORIAS ================= -->


    <!-- ================= RESULTADOS ================= -->
    <div class="explore-results">
      <% @restaurants.each do |restaurant| %>

        <div class="explore-card">

          <!-- IMAGEM -->
          <div class="explore-card-image">
            <% if restaurant.image_name.present? %>
              <%= image_tag restaurant.image_name,
                    class: "card-photo",
                    alt: restaurant.name %>
            <% else %>
              <%= image_tag "placeholder.jpg",
                    class: "card-photo",
                    alt: "Imagem n√£o dispon√≠vel" %>
            <% end %>
          </div>

          <!-- CONTE√öDO -->
          <div class="explore-card-content">

            <h3 class="restaurant-name"><%= restaurant.name %></h3>

            <% if restaurant.average_price.present? %>
              <p class="restaurant-price">
                üíµ Pre√ßo m√©dio: R$ <%= restaurant.average_price %>
              </p>
            <% end %>

            <p class="restaurant-category">
              üçΩÔ∏è <%= restaurant.category %>
            </p>

            <div class="restaurant-stats">
              <div class="stat-item">
                <i class="fas fa-map-marker-alt"></i>
                <span>
                  <%= restaurant.checkins.count %>
                  <%= "check-in".pluralize(restaurant.checkins.count) %>
                </span>
              </div>

              <div class="stat-item">
                <i class="fas fa-comment"></i>
                <span>
                  <%= restaurant.ratings.count %>
                  <%= "coment√°rio".pluralize(restaurant.ratings.count) %>
                </span>
              </div>
            </div>

            <div class="explore-card-actions">
              <% if user_signed_in? %>
                <%= link_to "Avaliar",
                      new_post_path(restaurant_id: restaurant.id),
                      class: "btn btn-sm btn-checkin" %>
              <% else %>
                <%= link_to "Entrar para fazer check-in",
                      new_user_session_path,
                      class: "btn btn-sm btn-checkin" %>
              <% end %>
            </div>

          </div>
        </div>

      <% end %>
    </div>
    <!-- ================= FIM RESULTADOS ================= -->

  </div>
</div>
