<div class="container mt-4">
  <div class="row">
    <div class="col-md-8 offset-md-2">
      <div class="card-profile p-4 shadow-sm">
        <h2 class="card-title text-center mb-4"> Meu Perfil</h2>

        <%# Exibição da Foto Atual %>
        <div class="text-center mb-4">
          <% if @user.profile_picture.attached? %>
            <%# Assumindo que o método `profile_picture` anexa a foto. Use `url_for` para exibi-la. %>
            <%= image_tag @user.profile_picture, class: "rounded-circle border border-primary", style: "width: 150px; height: 150px; object-fit: cover;" %>
          <% else %>
            <%# Placeholder se não houver foto %>
            <%= image_tag "placeholder_profile.png", class: "rounded-circle border", style: "width: 150px; height: 150px; object-fit: cover;" %>
          <% end %>
          <p><strong>Usuário:</strong> <%= @user.username || @user.email %></p>
          <p><strong>Tipo:</strong> <%= @user.owner? ? "Restaurante" : "Cliente" %></p>
        </div>


        <hr>

        <%# Retorno para o Perfil (Ajuste os links de navegação) %>
        <div class="text-center">
          <%= link_to "Editar perfil", edit_user_path(@user), class: "btn btn-outline-secondary mt-3" %>
        <ul class="nav nav-tabs mb-3">
          <li class="nav-item">
          <%= link_to "Categorias", categories_user_path(@user), class: "nav-link" %>
          </li>

          <li class="nav-item">
          <%= link_to "Seguidores", followers_user_path(@user), class: "nav-link" %>
          </li>

          <li class="nav-item">
          <%= link_to "Seguindo", following_user_path(@user), class: "nav-link" %>
          </li>

          <li class="nav-item">
          <%= link_to "Amigos", friends_user_path(@user), class: "nav-link" %>
          </li>
        </ul>
        <hr>


        </div>
      </div>
    </div>
  </div>
</div>

<h3>Minhas avaliações por categoria</h3>

<% @ratings_by_category.each do |category, ratings| %>
  <h4><%= category %></h4>

  <% ratings.group_by(&:restaurant).each do |restaurant, restaurant_ratings| %>
    <div class="card mb-2">
      <div class="card-body">
        <h5><%= restaurant.name %></h5>
        <ul>
          <% restaurant_ratings.each do |rating| %>
            <li>
              <strong><%= rating.score %>/5</strong>
              <% if rating.recommended == true %> (Recomendo)<% end %>
              <% if rating.recommended == false %> (Não recomendo)<% end %>
            </li>
          <% end %>
        </ul>
      </div>
    </div>
  <% end %>
<% end %>
