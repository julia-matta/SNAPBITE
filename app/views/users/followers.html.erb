<% content_for :title, "SnapBite - Meus seguidores" %>

<div class="followers-container">
  <div class="header-section">
    <h1>Seguidores de <span><%= @user.username.presence || @user.email %></span></h1>
  </div>

  <% if @followers.blank? %>
    <div class="empty-state">
      <p>Ainda não há seguidores.</p>
    </div>
  <% else %>
    <div class="followers-grid">
      <% @followers.each do |u| %>
        <div class="follower-card">
          <div class="follower-info">
            <% if u.profile_picture.attached? %>
              <%= image_tag url_for(u.profile_picture), class: "follower-avatar" %>
            <% else %>
              <div class="follower-avatar placeholder-avatar"></div>
            <% end %>

            <div class="follower-details">
              <%= link_to (u.username.presence || u.email), user_path(u), class: "follower-name" %>
              <span class="badge-role <%= u.owner? ? 'role-restaurante' : 'role-cliente' %>">
                <%= u.owner? ? "Restaurante" : "Cliente" %>
              </span>
            </div>
          </div>

          <% friendship = Friendship.find_by(user_id: current_user.id, friend_id: u.id) %>
          <div class="follower-actions">
            <% if current_user && current_user != u %>
              <% if current_user.following?(u) %>
                <%= button_to "Deixar de seguir", friendship_path(friendship), method: :delete, class: "btn-unfollow" %>
              <% else %>
                <%= button_to "Seguir", friendships_path(friend_id: u.id), method: :post, class: "btn-follow" %>
              <% end %>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>
  <% end %>
</div>
