<div class="explore-page">

  <div class="explore-container">

    <!-- ================= T√çTULOS ================= -->
    <h1>Explorar restaurantes</h1>
    <h4>Descubra novos sabores pela cidade</h4>

    <!-- ================= FILTROS ================= -->
    <%= form_with url: explore_path, method: :get, local: true do %>

      <div class="row mb-3">
        <div class="col">
          <%= label_tag :query, "Buscar" %>
          <%= text_field_tag :query,
                params[:query],
                class: "form-control",
                placeholder: "Nome, infos, endere√ßo..." %>
        </div>

        <div class="col">
          <%= label_tag :max_price, "Pre√ßo m√©dio at√© (R$)" %>
          <%= select_tag :max_price,
                options_for_select(@price_options, params[:max_price]),
                class: "form-select" %>
        </div>
      </div>

      <!-- BOT√ÉO TODAS -->
      <div class="category-buttons mb-3">
        <%= button_tag "Todas",
              type: :submit,
              name: :category,
              value: "",
              class: "category-btn #{'active' if params[:category].blank?}" %>
      </div>

      <!-- CATEGORIAS -->
      <div class="category-buttons mb-4">
        <% Restaurant::CATEGORIES.each do |cat| %>
          <%= button_tag cat,
                type: :submit,
                name: :category,
                value: cat,
                class: "category-btn #{'active' if params[:category] == cat}" %>
        <% end %>
      </div>

      <%= submit_tag "Filtrar", class: "btn-filtrar mb-4" %>

    <% end %>

    <!-- ================= RESULTADOS ================= -->
    <div class="explore-results">
      <% @restaurants.each do |restaurant| %>

        <div class="explore-card">

          <!-- IMAGEM -->
          <div class="explore-card-image">
            <% if restaurant.image_name.present? %>
              <%= image_tag restaurant.image_name,
                    class: "card-photo",
                    alt: restaurant.name %>
            <% else %>
              <%= image_tag "placeholder.jpg",
                    class: "card-photo",
                    alt: "Imagem n√£o dispon√≠vel" %>
            <% end %>
          </div>

          <!-- CONTE√öDO -->
          <div class="explore-card-content">

            <h3 class="restaurant-name"><%= restaurant.name %></h3>

            <% if restaurant.average_price.present? %>
              <p class="restaurant-price">
                üíµ Pre√ßo m√©dio: R$ <%= restaurant.average_price %>
              </p>
            <% end %>

            <p class="restaurant-category">
              üçΩÔ∏è <%= restaurant.category %>
            </p>

            <div class="restaurant-stats">
              <div class="stat-item">
                <i class="fas fa-map-marker-alt"></i>
                <span>
                  <%= restaurant.checkins.count %>
                  <%= "check-in".pluralize(restaurant.checkins.count) %>
                </span>
              </div>

              <div class="stat-item">
                <i class="fas fa-comment"></i>
                <span>
                  <%= restaurant.ratings.count %>
                  <%= "coment√°rio".pluralize(restaurant.ratings.count) %>
                </span>
              </div>
            </div>

            <div class="explore-card-actions">
              <% if user_signed_in? %>
                <%= button_to "Fazer check-in",
                      restaurant_checkins_path(restaurant),
                      method: :post,
                      class: "btn btn-sm btn-checkin" %>
              <% else %>
                <%= link_to "Entrar para fazer check-in",
                      new_user_session_path,
                      class: "btn btn-sm btn-checkin" %>
              <% end %>
            </div>

          </div>
        </div>

      <% end %>
    </div>

  </div>
</div>
